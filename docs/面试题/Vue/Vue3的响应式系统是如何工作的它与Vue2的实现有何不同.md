---
title: Vue3的响应式系统是如何工作的它与Vue2的实现有何不同?
tags:
  - vue
  - 面试题
date: 2024-05-30
---
# 一 Vue3的响应式系统是如何工作的?它与Vue2的实现有何不同?

Vue 3的响应式系统主要基于ES6的Proxy对象实现，与Vue 2使用Object.defineProperty()的方式有着显著的不同。以下是Vue 3响应式系统的工作原理及其与Vue 2的主要区别：

## 1.1 Vue 3响应式系统工作原理：

1. **Proxy对象**：Vue 3使用Proxy来创建一个代理对象，该代理覆盖了原始数据对象的所有访问和修改操作。当访问或修改代理对象的属性时，Proxy可以拦截这些操作并执行自定义逻辑。
    
2. **Getters与Setters**：Proxy通过getter和setter来监控数据访问和修改。getter在读取属性时触发，可以用来追踪依赖关系；setter在属性值改变时触发，用于通知系统更新依赖于该属性的视图。
    
3. **依赖收集**：Vue 3在getter中收集依赖，即将当前运行的组件或计算属性标记为依赖于该数据属性。当数据发生变化时，触发setter，Vue会遍历依赖列表并通知它们更新。
    
4. **深层响应**：Proxy可以深度代理对象，这意味着不论是直接修改对象的属性，还是添加、删除属性，都能自动触发响应。这比Vue 2更高效，Vue 2需要遍历对象并逐个定义属性来使其变为响应式。
    
5. **Effect系统**：Vue 3引入了新的effect系统，用于追踪副作用（如渲染函数或计算属性的执行）。当响应式数据变化时，相关effect会被调度重新执行，实现视图的自动更新。
    

## 1.2 与Vue 2的实现区别：

1. **性能提升**：Vue 3的Proxy实现允许在访问属性时才进行响应式处理，而不是像Vue 2那样在初始化时就需要遍历整个对象树，这在处理大型或深层嵌套对象时尤为显著。
    
2. **更全面的响应性**：Vue 3可以对数组的变异方法（如push、splice）以及新增和删除的属性做出响应，而Vue 2需要特殊处理或手动调用特定方法。
    
3. **更灵活的API**：Vue 3提供了更多的响应式API，如`reactive`、`ref`、`computed`和`watch`等，使得状态管理更加灵活多样。
    
4. **TypeScript友好**：Vue 3的Proxy实现与TypeScript有更好的集成，可以提供更强大的类型推断和类型安全。
    
5. **代码结构变化**：Vue 3鼓励使用Composition API，通过组合函数（setup）组织逻辑，这与Vue 2基于选项API的模式有很大不同，提高了代码的可重用性和可维护性。
    

总的来说，Vue 3的响应式系统利用了现代JavaScript特性，实现了更高效、更灵活的状态管理方式，同时也为开发者提供了更好的开发体验。