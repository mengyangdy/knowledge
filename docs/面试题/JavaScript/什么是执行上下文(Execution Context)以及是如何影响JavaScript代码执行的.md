---
title: 什么是执行上下文(Execution Context)以及是如何影响JavaScript代码执行的?
tags:
  - js
  - 面试题
date: 2024-05-28
---
# 一什么是执行上下文(Execution Context)以及是如何影响JavaScript代码执行的？

> 执行上下文（Execution Context）它定义了代码执行时的环境，包括其中的变量、函数以及 `this` 的值。每当JavaScript代码开始执行时，无论是全局代码还是函数代码，JavaScript引擎都会创建一个新的执行上下文来管理当前代码块的执行环境。执行上下文确定了代码在执行时能够访问哪些数据，以及如何访问这些数据。

## 1.1 执行上下文的类型

JavaScript中有三种主要类型的执行上下文：

1. **全局执行上下文（Global Execution Context）**：
    - 当JavaScript脚本开始执行时，会首先创建一个全局执行上下文。
    - 这个上下文包含了全局变量、全局函数以及`this`关键字指向全局对象（在浏览器中是`window`对象，在Node.js环境中是`global`对象）。
    - 全局上下文在整个程序生命周期中只创建一次，并且是所有其他执行上下文的根。
2. **函数执行上下文（Function Execution Context）**：
    - 每当一个函数被调用时，一个新的函数执行上下文会被创建。
    - 这个上下文包含了函数的局部变量、参数、内部函数以及`this`的值（根据函数调用方式决定）。
    - 函数执行上下文在函数调用结束并返回后会被销毁，除非涉及到闭包。
3. **Eval函数执行上下文（不常用，某些情况下由`eval()`函数创建）**：
    - 当使用`eval()`函数执行代码字符串时，会创建一个特殊的执行上下文。
    - 由于安全和性能原因，通常建议避免使用`eval()`。

## 1.2 影响代码执行的方式

1. **变量和函数的查找**：执行上下文决定了变量和函数的查找规则，即作用域链（Scope Chain）。每个执行上下文都有一个与之关联的作用域链，它是一个包含所有父执行上下文变量对象的链表，用于解决变量名的查找。
    
2. **`this`值的确定**：执行上下文决定了`this`的值。在全局上下文中，`this`指向全局对象；在函数上下文中，`this`的值依赖于函数的调用方式（例如，作为对象方法调用、普通函数调用、构造函数调用等）。
    
3. **代码执行顺序**：JavaScript引擎使用执行上下文栈（Execution Context Stack）来管理多个执行上下文。这是一个后进先出（LIFO）的数据结构，新的执行上下文被推入栈顶，执行完毕后从栈顶弹出。这确保了正确的代码执行顺序，比如函数嵌套调用时的返回流程。