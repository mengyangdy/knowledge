---
title: 描述浏览器缓存的工作原理
tags:
  - 浏览器
  - 面试题
date: 2024-06-03
---
# 一描述浏览器缓存的工作原理

浏览器缓存是Web性能优化的关键技术之一，它通过存储从服务器获取的资源（如HTML文件、图片、CSS样式表、JavaScript脚本等），使得重复访问时可以直接从本地加载，减少网络请求，加快页面加载速度。浏览器缓存的工作原理大致可以分为以下几个步骤和概念：

## 1.1 请求资源

当用户首次访问一个网页时，浏览器会向服务器发出请求，请求网页及其依赖的所有资源。

## 1.2 服务器响应

服务器接收到请求后，除了返回请求的资源外，还会在HTTP响应头中包含缓存相关的指令，比如：

- **ETag (实体标签)**：一个唯一标识特定版本资源的字符串。
- **Last-Modified (最后修改时间)**：资源在服务器上的最后修改时间。
- **Cache-Control**：控制缓存行为的指令，包括缓存时间、是否允许缓存等。
- **Expires**：资源过期时间，在此时间前，浏览器可以直接使用缓存而不去服务器验证。

## 1.3 浏览器缓存资源

根据服务器的响应头信息，浏览器决定如何缓存这些资源。如果资源被标记为可缓存，浏览器会将其存储在本地的缓存数据库中。

## 1.4 再次请求相同资源

当用户再次访问同一页面或相同资源时，浏览器首先检查本地缓存：

- **强缓存**：如果资源尚未过期（根据Cache-Control或Expires判断），浏览器直接从缓存中读取资源，无需向服务器发送请求，这是最快的缓存命中方式。
- **协商缓存**：如果资源已过期或没有设置强缓存，浏览器会发送一个请求到服务器，请求头中包含上次下载该资源时服务器返回的ETag或Last-Modified值。服务器根据这些值判断资源是否已改变：
    - 如果资源未变，服务器返回一个“304 Not Modified”状态码，告诉浏览器继续使用缓存中的资源。
    - 如果资源已变，服务器则返回新的资源内容和新的缓存指令。

## 1.5 更新缓存

如果资源发生变化（无论是初次下载还是通过协商缓存更新），浏览器会用新下载的资源替换旧的缓存副本，确保下次请求时能够获取到最新的内容。

## 1.6 小结

浏览器缓存机制有效地利用了本地存储资源，减少了不必要的网络传输，提高了网页加载速度和用户体验。开发者可以通过合理配置服务器的HTTP响应头，精细控制资源的缓存策略，达到性能优化的目的。

