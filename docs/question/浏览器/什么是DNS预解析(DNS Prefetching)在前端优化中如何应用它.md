---
title: 什么是DNS预解析(DNS Prefetching)在前端优化中如何应用它?
tags:
  - 计算机网络
  - 面试题
date: 2024-06-03
---
# 一 什么是DNS预解析(DNS Prefetching)?在前端优化中如何应用它?

DNS预解析（DNS Prefetching）是一种前端性能优化技术，它允许浏览器在实际需要之前预先解析域名。这一技术利用`<link rel="dns-prefetch">`标签或者通过JavaScript来告诉浏览器应提前解析哪些域名。具体来说，DNS预解析的工作机制如下：

1. **提前解析**: 当浏览器遇到页面头部的`dns-prefetch`标签时，它会立即开始解析指定的域名，即使这些域名所对应的资源（如图片、脚本、样式表等）尚未被请求。这一过程在后台进行，不影响页面当前的加载。
    
2. **缓存结果**: 解析得到的IP地址会被缓存在系统的DNS缓存中，如果用户随后确实访问了这些预解析的域名，由于DNS解析结果已经存在于缓存中，因此可以避免因DNS查询造成的延迟。
    
3. **优化体验**: 由于DNS查询通常需要一定时间（大约20到120毫秒，有时甚至更长），DNS预解析可以显著减少用户感受到的页面加载时间，特别是在移动网络环境下或首次访问某个域名时效果更为明显。
    

## 1.1 如何在前端优化中应用DNS预解析:

- **添加`dns-prefetch`标签**: 在HTML的`<head>`部分加入`<link rel="dns-prefetch" href="https://example.com">`，指示浏览器预解析`example.com`域名。你可以为任何预期在未来将要请求资源的外部域名添加这样的标签。
    
- **使用JavaScript**: 如果动态决定需要预解析的域名，可以通过JavaScript来动态插入`<link rel="dns-prefetch">`标签，或者使用`window.performance.getEntriesByType('navigation')[0].domainLookupStart`和`domainLookupEnd`等API来测量DNS查询时间，并据此做出优化决策。
    
- **合理选择预解析域名**: 不应无差别地对所有外部域名进行预解析，因为这会增加不必要的网络请求和占用系统资源。应该只对那些确定将被频繁访问或者对页面加载速度影响较大的域名进行预解析。
    
- **监控与测试**: 实施DNS预解析后，应通过前端性能监测工具（如Lighthouse、WebPageTest等）来评估其对页面加载时间的实际影响，并根据测试结果调整策略。
    

总之，DNS预解析是一种有效的前端性能优化手段，通过减少DNS解析时间来提升用户体验，尤其是在那些包含大量外部资源引用的网页上效果尤为显著。
