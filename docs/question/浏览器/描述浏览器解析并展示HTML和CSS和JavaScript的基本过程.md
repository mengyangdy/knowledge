---
title: 描述浏览器解析并展示HTML和CSS和JavaScript的基本过程?
tags:
  - 浏览器
  - 面试题
date: 2024-05-26
---
# 一 描述浏览器解析并展示HTML和CSS和JavaScript的基本过程?

浏览器解析并展示HTML、CSS和JavaScript的过程可以分为以下几个关键阶段：
1. 请求与接收文档
	- 浏览器向服务器发起HTTP(S)请求获取HTML文档。
	- 服务器响应并将HTML文档发送给浏览器。
	- 浏览器开始接收文档并准备解析。
2. HTML解析与DOM构造
	- **Token化**：浏览器将接收到的HTML文本分解成一系列的令牌（tokens），如开始标签、结束标签、属性名、属性值等。
	- **构建DOM树**：基于令牌，浏览器构建一个名为“文档对象模型”(DOM)的树状结构，其中每个节点代表文档中的一个部分，如元素、属性或者文本。
	- **加载外部资源**：解析HTML时遇到如CSS、JavaScript外部链接，浏览器会发出新的请求获取这些资源。
3. CSS解析与CSSOM构造
	- 对于CSS文件，浏览器会进行类似的操作：
	    - **解析CSS文本**：将CSS文本解析成规则集。
	    - **构建CSSOM树**：创建CSS对象模型树，该树表示CSS规则及其优先级。
	- 如果CSS是在HTML头部（`<head>` 内），浏览器会等待CSSOM构建完成后再继续渲染，以避免不必要的重绘和回流。这称为**阻塞渲染的CSS**。
4. 合并DOM与CSSOM构建渲染树
	- **渲染树构建**：浏览器将DOM树和CSSOM树合并，生成渲染树。渲染树只包含需要在页面上渲染的元素以及它们的样式信息，忽略如 `display: none` 的元素。
5. 布局与绘制
	- **布局**（也称重排或reflow）：根据渲染树计算每个节点的几何位置和尺寸，为页面元素分配空间。
	- **绘制**（painting）：遍历渲染树，将节点转换为屏幕上的像素。这涉及颜色填充、边框绘制、文字渲染等。
6. JavaScript执行
	- **加载与解析**：浏览器下载JavaScript文件，然后通过JavaScript引擎（如V8）解析和执行代码。
	- **影响DOM/CSSOM**：JavaScript可以修改DOM和CSSOM，导致重新布局和重绘。
	- **异步执行与事件处理**：JavaScript支持异步编程模式，如使用 `async/await`、Promise、Event Loop机制来处理事件和延迟执行任务，这可能在页面初次渲染后继续影响页面内容。
7. 交互与动态更新
	- 用户交互（点击、滚动等）或JavaScript触发的事件可以进一步修改DOM/CSSOM，引发新的布局、绘制过程。
	- 动态加载内容（Ajax请求）可导致上述流程循环，页面内容局部或全部更新。

整个过程是高度动态和相互依赖的，现代浏览器通过多种策略（如并发加载资源、懒加载、缓存机制等）来优化性能和用户体验。