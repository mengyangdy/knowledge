---
title: HTTP头中的那些字段与缓存策略有关它们各自如何工作?
tags:
  - 浏览器
  - 面试题
date: 2024-06-03
---
# 一 HTTP头中的那些字段与缓存策略有关?它们各自如何工作?

HTTP头部中与缓存策略紧密相关的主要字段包括但不限于以下几种，它们共同决定了浏览器或其他HTTP缓存设备如何存储和复用响应内容：

1. **Cache-Control**
    
    - **作用**: 这是最重要的缓存控制字段，用于详细定义缓存策略。它可以包含多个指令，如：
        - `public`: 指示响应可以被任何缓存（包括共享缓存）存储。
        - `private`: 表示响应只能被私有缓存（通常是用户的浏览器）存储，不能被代理服务器等共享缓存存储。
        - `no-cache`: 不是说不缓存，而是要求在使用前必须向源服务器验证其新鲜度（通过If-Modified-Since或ETag）。
        - `no-store`: 禁止任何缓存存储响应，适合敏感信息。
        - `max-age=<seconds>`: 指定从响应生成那一刻起，响应在缓存中保持新鲜的最大时间（秒）。
        - `s-maxage=<seconds>`: 类似于`max-age`，但仅应用于共享缓存。
2. **Expires**
    
    - **作用**: 过时的字段，指示响应何时过期，之后浏览器应认为该资源已陈旧。但现代浏览器更倾向于使用`Cache-Control: max-age`。
3. **ETag (Entity Tag)**
    
    - **作用**: 是资源的一个唯一标识符，服务器可以根据这个标识符判断资源是否发生了变化。在协商缓存中使用，浏览器在请求时发送If-None-Match头携带上次收到的ETag，服务器比较ETag，如果一致则返回304 Not Modified。
4. **Last-Modified**
    
    - **作用**: 表示资源在服务器上的最后修改时间。在协商缓存中使用，浏览器发送If-Modified-Since头携带上次收到的Last-Modified时间，服务器根据资源的实际修改时间判断是否需要发送新内容。
5. **Vary**
    
    - **作用**: 指示哪些请求头字段会影响缓存的响应。如果Vary指定的请求头在不同请求间有变化，即使URL相同，也会视为不同的缓存条目。

这些字段共同协作，帮助浏览器和其他中间缓存设备确定：

- 是否应该缓存响应。
- 缓存多久。
- 如何验证缓存项的新鲜度。
- 在何种条件下可以复用缓存的响应，而不是向服务器发送请求。

通过精确控制这些缓存策略，可以有效提升网站性能，减少服务器负载，并确保用户获得最新或适当的内容。

