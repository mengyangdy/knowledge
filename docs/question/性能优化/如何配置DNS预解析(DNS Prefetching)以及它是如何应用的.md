---
title: 如何配置DNS预解析(DNS Prefetching)以及它是如何应用的?
tags:
  - 性能优化
  - 面试题
date: 2024-05-29
---
# 一 如何配置DNS预解析(DNS Prefetching)以及它是如何应用的?

DNS预解析（DNS Prefetching）是一种前端优化技术，用于加快网页加载速度，通过在用户可能实际访问这些域名之前预先解析它们，减少了DNS查询延迟。以下是配置DNS预解析的方法及应用示例：

## 1.1 如何配置DNS预解析：

配置DNS预解析主要通过在网页的`<head>`部分添加特殊的`<link>`标签来实现。这个标签告诉浏览器在页面加载时预先解析指定的域名。基本语法如下：


```html
1 <link rel="dns-prefetch" href="//example.com">
```

- `rel="dns-prefetch"` 表明这是一个DNS预解析指令。
- `href="//example.com"` 是你希望浏览器预先解析的域名。注意这里使用双斜杠 (`//`) 开头，意味着使用当前页面的协议（HTTP或HTTPS）。

## 1.2 应用场景及注意事项：

1. **关键资源域名预解析**：对于页面加载过程中需要从第三方加载CSS、JavaScript、字体或图片的域名，可以预先解析，以减少首次加载这些资源时的延迟。
    
2. **后续页面域名预解析**：如果你知道用户可能会从当前页面导航到其他特定页面，可以预先解析那些页面所在域名。
    
3. **谨慎选择预解析的域名**：虽然DNS预解析可以提升性能，但不加选择地预解析所有域名可能会浪费资源，特别是对于用户不太可能访问的域名。合理分析用户行为，选择最有可能被访问的域名进行预解析。
    
4. **考虑隐私和安全**：预解析可能会泄露用户浏览意图，因此对于敏感或隐私相关的域名，应当避免使用预解析。
    
5. **HTTPS页面的考虑**：在HTTPS页面上，有些浏览器可能默认禁用DNS预解析以防止SSL剥离攻击。可以通过在页面头部加入适当的`<meta>`标签来指示浏览器允许DNS预解析，尽管这不是普遍推荐的做法，因为安全策略可能因浏览器而异。
    

## 1.3 示例代码片段：

```html
1<!DOCTYPE html>
2<html lang="en">
3<head>
4    <meta charset="UTF-8">
5    <title>Example Page</title>
6    <!-- 预解析CDN域名 -->
7    <link rel="dns-prefetch" href="//cdn.example.com">
8    <!-- 预解析API域名 -->
9    <link rel="dns-prefetch" href="//api.example.com">
10    <!-- 页面其他头部元素 -->
11</head>
12<body>
13    <!-- 页面内容 -->
14</body>
15</html>
```

通过以上配置，当用户访问该页面时，浏览器将立即开始解析`cdn.example.com`和`api.example.com`这两个域名，即使用户还没有直接请求这些域名下的资源，从而在用户真正需要时加快了资源的加载速度。DNS预解析（DNS Prefetching）是一种前端优化技术，用于加快网页加载速度，通过在用户可能实际访问这些域名之前预先解析它们，减少了DNS查询延迟。以下是配置DNS预解析的方法及应用示例：

### 如何配置DNS预解析：

配置DNS预解析主要通过在网页的`<head>`部分添加特殊的`<link>`标签来实现。这个标签告诉浏览器在页面加载时预先解析指定的域名。基本语法如下：

Html

```
1<link rel="dns-prefetch" href="//example.com">
```

- `rel="dns-prefetch"` 表明这是一个DNS预解析指令。
- `href="//example.com"` 是你希望浏览器预先解析的域名。注意这里使用双斜杠 (`//`) 开头，意味着使用当前页面的协议（HTTP或HTTPS）。

### 应用场景及注意事项：

1. **关键资源域名预解析**：对于页面加载过程中需要从第三方加载CSS、JavaScript、字体或图片的域名，可以预先解析，以减少首次加载这些资源时的延迟。
    
2. **后续页面域名预解析**：如果你知道用户可能会从当前页面导航到其他特定页面，可以预先解析那些页面所在域名。
    
3. **谨慎选择预解析的域名**：虽然DNS预解析可以提升性能，但不加选择地预解析所有域名可能会浪费资源，特别是对于用户不太可能访问的域名。合理分析用户行为，选择最有可能被访问的域名进行预解析。
    
4. **考虑隐私和安全**：预解析可能会泄露用户浏览意图，因此对于敏感或隐私相关的域名，应当避免使用预解析。
    
5. **HTTPS页面的考虑**：在HTTPS页面上，有些浏览器可能默认禁用DNS预解析以防止SSL剥离攻击。可以通过在页面头部加入适当的`<meta>`标签来指示浏览器允许DNS预解析，尽管这不是普遍推荐的做法，因为安全策略可能因浏览器而异。
    

### 示例代码片段：


```html
1<!DOCTYPE html>
2<html lang="en">
3<head>
4    <meta charset="UTF-8">
5    <title>Example Page</title>
6    <!-- 预解析CDN域名 -->
7    <link rel="dns-prefetch" href="//cdn.example.com">
8    <!-- 预解析API域名 -->
9    <link rel="dns-prefetch" href="//api.example.com">
10    <!-- 页面其他头部元素 -->
11</head>
12<body>
13    <!-- 页面内容 -->
14</body>
15</html>
```

通过以上配置，当用户访问该页面时，浏览器将立即开始解析`cdn.example.com`和`api.example.com`这两个域名，即使用户还没有直接请求这些域名下的资源，从而在用户真正需要时加快了资源的加载速度。

