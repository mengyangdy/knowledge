---
title: Vue的双向数据绑定是如何工作的简述下基本原理?
tags:
  - vue
  - 面试题
date: 2024-05-29
---
# 一 Vue的双向数据绑定是如何工作的?简述下基本原理?

> Vue的双向数据绑定是通过一种称为“数据劫持结合发布者-订阅者模式”的机制来实现的。这一机制允许数据模型（Model）的变化自动反映到用户界面（View）上，反之亦然，从而实现双向同步。其核心原理如下：

## 1.1 数据劫持（Data Hijacking）

Vue使用 `Object.defineProperty` 方法来重定义（或“劫持”）数据对象的getter和setter。这是ES5提供的一个特性，允许开发者自定义对象属性的访问和修改行为。

- **Getter**：当访问一个属性时，getter函数会被触发，Vue可以在此时追踪这个属性的依赖关系，即哪些视图部分依赖于这个数据。
- **Setter**：当修改一个属性时，setter函数会被触发，Vue利用setter来检测数据变化，并通知所有依赖于这个数据的视图部分进行更新。

## 1.2 发布者-订阅者模式（Publisher-Subscriber Pattern）

- **Dep（依赖管理器）**：Vue内部有一个依赖管理器（Dep），用于跟踪每个属性的依赖项（Watcher）。当数据改变时，Dep会通知所有订阅者（Watcher）。
- **Watcher（观察者）**：Watcher是Vue实例的一个内部机制，用于观察数据的变化，并在数据变化时执行相应的回调函数，即更新视图。每个Watcher都对应一个具体的更新操作，如视图的某个部分更新或计算属性的重新计算。

## 1.3 双向绑定的实现（v-model）

Vue提供了一个指令 `v-model`，它是实现表单控件与数据双向绑定的便捷方式。`v-model` 在背后实际上是对数据劫持和发布-订阅模式的封装，它的工作原理如下：

- **数据到视图**：当数据模型的值发生变化时，Vue通过数据劫持触发setter，setter进而通知相关Watcher，最终触发视图更新。
- **视图到数据**：当用户在表单控件中输入数据时，Vue通过 `v-model` 指令监听输入事件（如input事件），捕获到变化后，直接修改相应的数据模型，触发数据劫持的setter，从而完成从视图到数据的更新。

综上所述，Vue的双向数据绑定通过数据劫持监听数据变化，并利用发布-订阅模式通知视图更新，同时通过 `v-model` 指令简化了表单控件的双向绑定实现，使得数据与视图之间的同步变得直观且高效。